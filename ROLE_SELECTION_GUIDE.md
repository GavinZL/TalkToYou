# 角色选择功能说明

## 功能概述

角色选择功能允许用户为AI对话选择不同的角色，每个角色都有独特的性格、专长和对话风格。支持预设角色和自定义角色。

## 使用方法

### 1. 打开角色选择页面

在对话界面，点击**导航栏左侧的角色按钮**（显示当前角色名称），即可打开角色选择页面。

### 2. 选择预设角色

系统提供了12个预设角色：

- **数学老师** - 耐心讲解数学知识，培养逻辑思维
- **律师** - 提供专业法律咨询，分析法律问题
- **健康教练** - 指导健康生活，制定运动饮食计划
- **爸爸** - 慈爱的父亲形象，给予温暖支持
- **妈妈** - 温柔的母亲形象，细心体贴关怀
- **心理咨询师** - 专业心理咨询，倾听内心声音
- **英语老师** - 提升英语能力，纠正语法词汇
- **职业顾问** - 规划职业发展，提供职场建议
- **编程导师** - 教授编程知识，培养编程思维
- **美食顾问** - 推荐美食菜谱，分享烹饪技巧
- **旅行顾问** - 规划旅行路线，分享旅行攻略
- **理财顾问** - 规划财务管理，提供投资建议

点击任意角色卡片即可选择该角色，选中后会有绿色勾选标记。

### 3. 创建自定义角色

#### 步骤：

1. 点击底部的 **"+ 自定义角色"** 浮动按钮
2. 填写角色信息：
   - **角色名称**：给角色起个名字
   - **简短描述**：用一句话描述角色特点
   - **选择图标**：从12个图标中选择一个代表角色的图标
   - **选择颜色**：为角色卡片选择一个主题色
   - **性格特点**：描述角色的性格特征（例如：友好、专业、耐心）
   - **角色提示词**：这是最重要的部分，详细描述AI应该如何扮演这个角色
3. 点击 **"保存"** 完成创建

#### 角色提示词编写技巧：

好的角色提示词应该包含：
- 角色的身份和专长
- 角色的性格特点
- 角色的行为方式
- 角色的回答风格
- 角色关注的重点

**示例：**
```
你是一位经验丰富的数学老师，擅长用浅显易懂的方式讲解数学概念。
你会先了解学生的水平，然后循序渐进地引导学生思考，而不是直接给出答案。
你鼓励学生独立思考，培养数学思维。
```

### 4. 编辑/删除自定义角色

- **编辑**：长按自定义角色卡片，选择"编辑"
- **删除**：长按自定义角色卡片，选择"删除"，确认后即可删除

### 5. 角色的应用

选择角色后：
- 当前对话会话会立即使用新角色
- 角色会影响AI的回答风格和内容
- 切换角色不会清空对话历史
- 角色设置会持久保存，重启应用后仍然有效

## 技术实现

### 数据模型

#### RolePreset
```swift
struct RolePreset {
    let id: UUID           // 唯一标识
    var name: String       // 角色名称
    var prompt: String     // 角色提示词
    var personality: String // 性格特点
    var icon: String       // SF Symbol 图标名称
    var color: String      // 主题色
    var description: String // 简短描述
    var isCustom: Bool     // 是否为自定义角色
}
```

### 文件结构

```
TalkToYou/
├── Models/
│   └── RolePresets.swift          # 角色数据模型和管理器
├── Views/
│   ├── RoleSelectionView.swift    # 角色选择主视图
│   └── ChatView.swift             # 聊天视图（已更新）
```

### 数据持久化

- **预设角色**：硬编码在 `RolePresetsManager` 中
- **自定义角色**：使用 `UserDefaults` 存储，自动保存和加载
- **当前选中角色**：通过 `SettingsManager.settings.roleConfig` 保存

## 界面特点

### 角色卡片设计
- 渐变色圆形图标
- 角色名称
- 简短描述（2行）
- 选中状态标记（绿色勾选）
- 卡片阴影效果
- 点击选择，长按编辑/删除

### 布局
- 3列网格布局（适配各种屏幕）
- 预设角色和自定义角色分组显示
- 浮动的"添加"按钮固定在底部

### 交互体验
- 选择角色后0.3秒自动关闭页面
- 删除角色前有二次确认
- 表单验证（名称和提示词不能为空）
- 实时预览角色外观

## 最佳实践

### 1. 角色提示词建议长度
- 最少：50字
- 推荐：100-200字
- 最多：500字

### 2. 角色设计建议
- **明确角色定位**：一个角色应该有明确的专长领域
- **一致的人设**：性格、说话风格要保持一致
- **适当的边界**：明确角色的能力范围和限制
- **情感共鸣**：让角色有温度，能建立情感连接

### 3. 使用场景举例

#### 学习场景
- 选择"数学老师"帮助解答数学问题
- 选择"英语老师"练习英语对话
- 选择"编程导师"学习编程知识

#### 生活场景
- 选择"健康教练"咨询健身计划
- 选择"美食顾问"寻找食谱
- 选择"旅行顾问"规划旅行

#### 情感支持
- 选择"爸爸"或"妈妈"获得温暖陪伴
- 选择"心理咨询师"疏导情绪

#### 专业咨询
- 选择"律师"咨询法律问题
- 选择"理财顾问"规划财务
- 选择"职业顾问"规划职业发展

## 注意事项

1. **角色不等于专业**：虽然角色有专业设定，但AI的回答仍基于大语言模型，不能替代真正的专业人士建议
2. **提示词质量**：角色的表现很大程度上取决于提示词的质量，建议多次调整优化
3. **数据隐私**：自定义角色数据存储在本地设备，不会上传到云端
4. **角色数量**：建议自定义角色数量不超过20个，太多会影响选择效率

## 未来规划

- [ ] 角色模板市场（用户可分享和下载角色）
- [ ] 角色对话示例预览
- [ ] 多轮对话角色切换
- [ ] 角色导入/导出功能
- [ ] 角色使用统计
- [ ] AI自动优化角色提示词
